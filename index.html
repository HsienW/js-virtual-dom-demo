<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Virtual Dom Simulation</title>
</head>
<body>
<script type="module">
    import {CustomElement} from './element.js';
    import {diff} from './diff.js';
    import {patch} from './patch.js';
    // import {customSetAttribute} from './util.js';

    // 一個 Virtual Dom 下的 Node 展開後, 類似下面這個 element object
    // let element = {
    //     tagName: 'ul',  // Node 標籤名
    //     props: {  // DOM 的屬性，用一個對象存儲鍵值對
    //         id: 'list'
    //     },
    //     children: [  // Node 的子節點
    //         {tagName: 'li', props: {class: 'item'}, children: ["Item 1"]},
    //         {tagName: 'li', props: {class: 'item'}, children: ["Item 2"]},
    //         {tagName: 'li', props: {class: 'item'}, children: ["Item 3"]},
    //     ]
    // }

    let count = 0;

    const ulNode = new CustomElement('ul', {id: 'list'}, [
        new CustomElement('li', {class: 'item'}, ['Item 1']),
        new CustomElement('li', {class: 'item'}, ['Item 2']),
        new CustomElement('li', {class: 'item'}, ['Item 3'])
    ]);

    const isChangeUlNode = new CustomElement('ul', {id: 'list'}, [
        new CustomElement('li', {class: 'item'}, ['Item 1-1', 'Item 1-2', 'Item 1-3']),
        new CustomElement('li', {class: 'item-test'}, ['Item 2-1', 'Item 2-2', 'Item 2-3']),
        new CustomElement('li', {class: 'item'}, ['Item 3']),
        new CustomElement('li', {class: 'item-test'}, ['Item 4'])
    ]);

    console.log(ulNode);
    //
    const ulRootDom = ulNode.render();
    document.body.appendChild(ulRootDom);


    setTimeout(function () {
        let patches = diff(ulNode, isChangeUlNode)
        patch(ulNode.render, patches)
    }, 3000)


    //  const createElement = function(type, props, children) {
    //      // 直接 return 一個 object, 用來產生 Virtual Dom 下的 node 結構
    //      // 把 children 掛入 props, 以便後續能用 this.props.children 拿取子 node
    //      return {
    //          type,
    //          props: {
    //              ...props,
    //              ...children
    //          }
    //      }
    // }
    // const render = function (vDom, container) {
    //      // 用來存放 vDom 的 object
    //     let dom;
    //
    //     // 先檢查當前要 render 的 vDom 是 object or string
    //     if(typeof vDom !== 'object') {
    //         // 是 string 的話, 創建 TextNode
    //         dom = document.createTextNode(vDom)
    //     } else {
    //         // 是 object 的話, 創建 Element
    //         dom = document.createElement(vDom.type);
    //     }
    // }

</script>
</body>
</html>
